<!-- ðŸŒ Standard-Header: DABubble + Suche (nur wenn NICHT Mobile-Chat/Thread) -->
<header
  class="app-header"
  *ngIf="!isMobile || currentMobileView === 'sidebar'"

>
  <div class="header-top">
    <!-- ðŸ”µ DABubble Logo + Name -->
    <div class="logo-group">
      <img
        src="assets/Logo.png"
        alt="Logo"
        class="logo"
        matTooltip="Zur Startseite"
      />
      <span class="title">DABubble</span>
    </div>

    <!-- ðŸ” Suche (nur Desktop) -->
    <div class="search-container desktop-search" (click)="$event.stopPropagation()">
      <input
        type="text"
        [(ngModel)]="searchTerm"
        (input)="onSearch()"
        (focus)="searchFocused = true"
        (blur)="onBlur()"
        placeholder="Devspace durchsuchen"
        matTooltip="Channel oder Person suchen"
      />
      <mat-icon>search</mat-icon>

      <!-- ðŸ”½ Suchergebnisse -->
      <div class="search-dropdown" *ngIf="searchFocused && filteredResults.length">
        <div
          class="search-result"
          *ngFor="let result of filteredResults"
          (click)="selectResult(result)"
        >
          <img
            class="avatar"
            [src]="result.type === 'channel' ? 'assets/channel.png' : (result.avatar || 'assets/default-avatar.png')"
            alt="Avatar"
          />
          <div class="info">
            <div class="name">{{ result.name }}</div>
            <div class="tag">
              {{ result.type === 'channel' ? '#' : '@' }}{{ result.name }}
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- ðŸ‘¤ Benutzerprofil -->
    <div class="user-profile" #dropdownContainer (click)="toggleDropdown()">
      <span class="user-name" matTooltip="Angemeldet als {{ userName }}">
        {{ userName }}
      </span>
      <mat-icon class="user-icon">expand_more</mat-icon>
      <img [src]="currentUser?.avatar" class="avatar" alt="Avatar" />

      <!-- Dropdown -->
      <div
        class="dropdown-menu"
        *ngIf="dropdownOpen"
        (click)="$event.stopPropagation()"
      >
        <button (click)="openProfileDialog()">Profil</button>
        <button (click)="logout()">Logout</button>
      </div>
    </div>
  </div>

  <!-- ðŸ” Suche (nur Mobile) -->
  <div
  class="search-container mobile-search"
  *ngIf="!isMobile || currentMobileView === 'sidebar'"
  (click)="$event.stopPropagation()">

    <input
      type="text"
      [(ngModel)]="searchTerm"
      (input)="onSearch()"
      (focus)="searchFocused = true"
      (blur)="onBlur()"
      placeholder="Devspace durchsuchen"
      matTooltip="Channel oder Person suchen"
    />
    <mat-icon>search</mat-icon>

    <div class="search-dropdown" *ngIf="searchFocused && filteredResults.length">
      <div
        class="search-result"
        *ngFor="let result of filteredResults"
        (click)="selectResult(result)"
        [matTooltip]="result.display"
      >
        <mat-icon class="icon" *ngIf="result.type === 'channel'">tag</mat-icon>
        <mat-icon class="icon" *ngIf="result.type === 'user'">person</mat-icon>
        <span>{{ result.display }}</span>
      </div>
    </div>
  </div>
</header>

<!-- ðŸ“± Devspace Header (nur in Mobile, wenn NICHT Sidebar) -->
<header
  class="app-header devspace-header"
  *ngIf="isMobile && currentMobileView !== 'sidebar'"
>
  <div class="header-top">
    <!-- ðŸ”™ ZurÃ¼ck-Button -->
    <button class="back-button" (click)="setMobileView('sidebar')">
      <mat-icon>arrow_back</mat-icon>
    </button>

    <!-- ðŸ”· Devspace Logo + Name -->
    <div class="logo-group">
      <img src="assets/Dev.png" alt="Devspace Logo" class="logo" />
      <span class="title">Devspace</span>
    </div>

    <!-- ðŸ‘¤ Profil -->
    <div class="user-profile" #dropdownContainer (click)="toggleDropdown()">
      <img [src]="currentUser?.avatar" class="avatar" alt="Avatar" />
      <mat-icon class="user-icon">expand_more</mat-icon>

      <div
        class="dropdown-menu"
        *ngIf="dropdownOpen"
        (click)="$event.stopPropagation()"
      >
        <button (click)="openProfileDialog()">Profil</button>
        <button (click)="logout()">Logout</button>
      </div>
    </div>
  </div>
</header>


<!-- ðŸ“„ Router View -->
<main class="app-main">
  <router-outlet></router-outlet>
</main>

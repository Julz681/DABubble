<header class="app-header">
  <div class="logo-bar">
    <img src="assets/Logo.png" alt="Logo" class="logo" />
    <span class="title">DABubble</span>
  </div>

  <!-- 🔍 Suchleiste -->
  <div class="search-container" (click)="$event.stopPropagation()">
    <input
      type="text"
      [(ngModel)]="searchTerm"
      (input)="onSearch()"
      (focus)="searchFocused = true"
      (blur)="onBlur()"
      placeholder="Devspace durchsuchen"
    />
    <mat-icon>search</mat-icon>

    <!-- 🔽 Ergebnisliste -->
    <div class="search-dropdown" *ngIf="searchFocused && filteredResults.length">
      <div
        class="search-result"
        *ngFor="let result of filteredResults"
        (click)="selectResult(result)"
      >
        <mat-icon class="icon" *ngIf="result.type === 'channel'">tag</mat-icon>
        <mat-icon class="icon" *ngIf="result.type === 'user'">person</mat-icon>
        <span>{{ result.display }}</span>
      </div>
    </div>
  </div>

  <!-- Benutzerprofil -->
  <div class="user-profile" #dropdownContainer>
    <span>{{ userName }}</span>
    <mat-icon (click)="toggleDropdown()">expand_more</mat-icon>
    <img src="assets/Frederik Beck.png" class="avatar" />

    <div
      class="dropdown-menu"
      *ngIf="dropdownOpen"
      (click)="$event.stopPropagation()"
    >
      <button (click)="openProfileDialog()">Profil</button>
      <button (click)="logout()">Logout</button>
    </div>
  </div>
</header>

<main class="app-main">
  <app-chat-layout></app-chat-layout>
</main>

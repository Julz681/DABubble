<header class="app-header">
  <!-- Logo-Bereich -->
  <div class="logo-bar">
    <img
      src="assets/Logo.png"
      alt="Logo"
      class="logo"
      matTooltip="Zur Startseite"
    />
    <span class="title">DABubble</span>
  </div>

  <!-- 🔍 Suchleiste -->
  <div class="search-container" (click)="$event.stopPropagation()">
    <input
      type="text"
      [(ngModel)]="searchTerm"
      (input)="onSearch()"
      (focus)="searchFocused = true"
      (blur)="onBlur()"
      placeholder="Devspace durchsuchen"
      matTooltip="Channel oder Person suchen"
    />
    <mat-icon matTooltip="Suchen">search</mat-icon>

    <!-- 🔽 Ergebnisliste -->
    <div class="search-dropdown" *ngIf="searchFocused && filteredResults.length">
      <div
        class="search-result"
        *ngFor="let result of filteredResults"
        (click)="selectResult(result)"
        [matTooltip]="result.display"
      >
        <mat-icon class="icon" *ngIf="result.type === 'channel'">tag</mat-icon>
        <mat-icon class="icon" *ngIf="result.type === 'user'">person</mat-icon>
        <span>{{ result.display }}</span>
      </div>
    </div>
  </div>

  <!-- Benutzerprofil -->
  <div class="user-profile" #dropdownContainer>
    <span matTooltip="Angemeldet als {{ userName }}">{{ userName }}</span>
    <mat-icon
      (click)="toggleDropdown()"
      matTooltip="Menü öffnen"
      style="cursor: pointer;"
    >expand_more</mat-icon>
    <img
      [src]="currentUser?.avatar"
      class="avatar"
      alt="Avatar"
    />

    <div
      class="dropdown-menu"
      *ngIf="dropdownOpen"
      (click)="$event.stopPropagation()"
    >
      <button (click)="openProfileDialog()" matTooltip="Profil ansehen und bearbeiten">
        Profil
      </button>
      <button (click)="logout()" matTooltip="Abmelden">
        Logout
      </button>
    </div>
  </div>
</header>

<main class="app-main">
  <router-outlet></router-outlet>
</main>
